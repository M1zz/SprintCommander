#!/bin/bash
# SprintCommander - Claude Code ì—°ë™ ì…‹ì—… ìŠ¤í¬ë¦½íŠ¸
# ì–´ë–¤ ë¨¸ì‹ ì—ì„œë“  ì‹¤í–‰í•˜ë©´ ~/CLAUDE.mdë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
#
# ì‚¬ìš©ë²•:
#   bash docs/setup-claude-md.sh
#
# ì´ë¯¸ ~/CLAUDE.mdê°€ ìžˆìœ¼ë©´ ë°±ì—… í›„ SprintCommander ê·œì¹™ì„ ì¶”ê°€í•©ë‹ˆë‹¤.

TARGET="$HOME/CLAUDE.md"
MARKER="## ìŠ¤í”„ë¦°íŠ¸ ë°±ë¡œê·¸ ìƒì„±"

# ì´ë¯¸ ë™ì¼ ê·œì¹™ì´ ìžˆìœ¼ë©´ ìŠ¤í‚µ
if [ -f "$TARGET" ] && grep -q "$MARKER" "$TARGET"; then
    echo "âœ… ~/CLAUDE.mdì— SprintCommander ê·œì¹™ì´ ì´ë¯¸ ì¡´ìž¬í•©ë‹ˆë‹¤."
    exit 0
fi

# ê¸°ì¡´ íŒŒì¼ì´ ìžˆìœ¼ë©´ ë’¤ì— ì¶”ê°€, ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±
if [ -f "$TARGET" ]; then
    echo "" >> "$TARGET"
    echo "---" >> "$TARGET"
    echo "" >> "$TARGET"
    echo "ðŸ“Ž ê¸°ì¡´ ~/CLAUDE.mdì— SprintCommander ê·œì¹™ì„ ì¶”ê°€í•©ë‹ˆë‹¤."
else
    echo "ðŸ“ ~/CLAUDE.mdë¥¼ ìƒˆë¡œ ìƒì„±í•©ë‹ˆë‹¤."
fi

cat >> "$TARGET" << 'EOF'
# Global Rules

## ìŠ¤í”„ë¦°íŠ¸ ë°±ë¡œê·¸ ìƒì„±

ì‚¬ìš©ìžê°€ "ë°±ë¡œê·¸ ë§Œë“¤ì–´", "ìŠ¤í”„ë¦°íŠ¸ ë¶„ì„í•´", "íƒœìŠ¤í¬ ìƒì„±í•´"ë¼ê³  í•˜ë©´:

1. `.sprintcommander/_schema.json`ì—ì„œ projectIdì™€ í¬ë§· í™•ì¸
2. `.sprintcommander/tasks.json`ì—ì„œ ê¸°ì¡´ íƒœìŠ¤í¬ í™•ì¸ (ì¤‘ë³µ ê¸ˆì§€, ê¸°ì¡´ íƒœìŠ¤í¬ ë°˜ë“œì‹œ ìœ ì§€)
3. ì†ŒìŠ¤ ì½”ë“œë¥¼ íƒìƒ‰í•´ì„œ ì•„ëž˜ ê¸°ì¤€ìœ¼ë¡œ íƒœìŠ¤í¬ ë„ì¶œ:
   - TODO/FIXME/HACK ì£¼ì„
   - ì—ëŸ¬ í•¸ë“¤ë§ì´ ë¶€ì¡±í•œ ê³³ (try? ë‚¨ìš©, ë¹ˆ catch ë“±)
   - í…ŒìŠ¤íŠ¸ê°€ ì—†ëŠ” í•µì‹¬ ë¡œì§
   - ì ‘ê·¼ì„±(Accessibility) ë¯¸ë¹„
   - ì„±ëŠ¥ ê°œì„  í¬ì¸íŠ¸ (ë¶ˆí•„ìš”í•œ re-render, ë¬´ê±°ìš´ ì—°ì‚° ë“±)
   - ì‚¬ìš©ìž ê²½í—˜ ê°œì„  (UI/UX ë²„ê·¸, ëˆ„ë½ëœ ê¸°ëŠ¥)
   - ë¦¬íŒ©í† ë§ì´ í•„ìš”í•œ ë³µìž¡í•œ í•¨ìˆ˜
4. `.sprintcommander/tasks.json`ì— ê¸°ì¡´ ë°°ì—´ì„ ìœ ì§€í•˜ë©´ì„œ ìƒˆ íƒœìŠ¤í¬ë¥¼ ì¶”ê°€ ì €ìž¥
5. í¬ë§·ì€ `_schema.json`ì˜ exampleì„ ë”°ë¦„
6. ê¸°ë³¸ê°’: status=`"ë°±ë¡œê·¸"`, assignee=`"ME"`, assigneeColorHex=`"4FACFE"`
7. ìš°ì„ ìˆœìœ„: high=ë²„ê·¸/í¬ëž˜ì‹œ/ë°ì´í„°ì†ì‹¤, medium=ê¸°ëŠ¥ê°œì„ /ë¦¬íŒ©í† ë§, low=ì½”ë“œì •ë¦¬/ë¬¸ì„œí™”
8. ìŠ¤í† ë¦¬ í¬ì¸íŠ¸ëŠ” í”¼ë³´ë‚˜ì¹˜(1, 2, 3, 5, 8, 13), ëŒ€ë¶€ë¶„ 1~5 ë²”ìœ„
9. íƒœìŠ¤í¬ ìˆ˜ëŠ” 10~20ê°œ, ê°ê° í•˜ë‚˜ì˜ PRë¡œ ì²˜ë¦¬ ê°€ëŠ¥í•œ í¬ê¸°ë¡œ ìª¼ê°¤ ê²ƒ
10. ê° íƒœìŠ¤í¬ì˜ idëŠ” ìƒˆ UUIDë¥¼ ìƒì„±, projectIdëŠ” `_schema.json`ì˜ ê°’ì„ ì •í™•ížˆ ì‚¬ìš©
11. ì €ìž¥ í›„ ì¶”ê°€í•œ íƒœìŠ¤í¬ ëª©ë¡ì„ ìš”ì•½í•´ì„œ ë³´ì—¬ì¤„ ê²ƒ

## íƒœìŠ¤í¬ ìž‘ì—… íë¦„

ì‚¬ìš©ìžê°€ "ë‹¤ìŒ íƒœìŠ¤í¬ í•´", "ìž‘ì—… ì‹œìž‘", "íƒœìŠ¤í¬ í•˜ë‚˜ í•´ì¤˜"ë¼ê³  í•˜ë©´:

1. `.sprintcommander/tasks.json`ì„ ì½ëŠ”ë‹¤
2. ì•„ëž˜ ìš°ì„ ìˆœìœ„ë¡œ ìž‘ì—…í•  íƒœìŠ¤í¬ 1ê°œë¥¼ ì„ íƒí•œë‹¤:
   - statusê°€ `"ë°±ë¡œê·¸"` ë˜ëŠ” `"í•  ì¼"`ì¸ ê²ƒ ì¤‘ì—ì„œ
   - priority `high` â†’ `medium` â†’ `low` ìˆœì„œë¡œ
   - ê°™ì€ ìš°ì„ ìˆœìœ„ë©´ storyPointsê°€ ìž‘ì€ ê²ƒ ë¨¼ì € (ë¹ ë¥´ê²Œ ëë‚¼ ìˆ˜ ìžˆëŠ” ê²ƒ)
3. í•´ë‹¹ íƒœìŠ¤í¬ì˜ statusë¥¼ `"ì§„í–‰ ì¤‘"`ìœ¼ë¡œ ë³€ê²½í•˜ê³  `tasks.json`ì— ì €ìž¥í•œë‹¤
4. íƒœìŠ¤í¬ ì œëª©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì œ ì½”ë“œ ìž‘ì—…ì„ ìˆ˜í–‰í•œë‹¤
5. ìž‘ì—…ì´ ì™„ë£Œë˜ë©´ statusë¥¼ `"ì™„ë£Œ"`ë¡œ ë³€ê²½í•˜ê³  `tasks.json`ì— ì €ìž¥í•œë‹¤
6. ì™„ë£Œ ìš”ì•½ì„ ë³´ì—¬ì¤€ë‹¤: íƒœìŠ¤í¬ ì œëª©, ë³€ê²½í•œ íŒŒì¼ ëª©ë¡, ë‹¤ìŒ ë°±ë¡œê·¸ íƒœìŠ¤í¬ ë¯¸ë¦¬ë³´ê¸°

ì‚¬ìš©ìžê°€ "ì´ê±° í•´ì¤˜"ë¼ë©° íŠ¹ì • íƒœìŠ¤í¬ë¥¼ ì§€ì •í•˜ë©´:
- tasks.jsonì—ì„œ í•´ë‹¹ íƒœìŠ¤í¬ë¥¼ ì°¾ì•„ ìœ„ 3~6 ê³¼ì •ì„ ë™ì¼í•˜ê²Œ ìˆ˜í–‰í•œë‹¤

ì‚¬ìš©ìžê°€ "ê³„ì† í•´", "ë‹¤ìŒ"ì´ë¼ê³  í•˜ë©´:
- ì´ì „ì— ì™„ë£Œí•œ íƒœìŠ¤í¬ ë‹¤ìŒìœ¼ë¡œ ìœ„ ê³¼ì •ì„ ë°˜ë³µí•œë‹¤

### ì£¼ì˜ì‚¬í•­
- tasks.jsonì„ ìˆ˜ì •í•  ë•Œ ë‹¤ë¥¸ íƒœìŠ¤í¬ì˜ ë°ì´í„°ëŠ” ì ˆëŒ€ ë³€ê²½í•˜ì§€ ì•ŠëŠ”ë‹¤
- í•œ ë²ˆì— 1ê°œ íƒœìŠ¤í¬ë§Œ "ì§„í–‰ ì¤‘"ìœ¼ë¡œ ë³€ê²½í•œë‹¤
- ìž‘ì—… ë„ì¤‘ ì‹¤íŒ¨í•˜ê±°ë‚˜ ì¤‘ë‹¨ë˜ë©´ statusë¥¼ ì›ëž˜ëŒ€ë¡œ ë˜ëŒë¦°ë‹¤
- ì½”ë“œ ë³€ê²½ í›„ ë¹Œë“œ/í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ë©´ í™•ì¸í•œë‹¤
EOF

echo "âœ… ì™„ë£Œ! $(wc -l < "$TARGET" | tr -d ' ')ì¤„ ìž‘ì„±ë¨ â†’ $TARGET"
